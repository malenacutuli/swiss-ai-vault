apiVersion: v1
kind: ConfigMap
metadata:
  name: app-config
  namespace: swissbrain
  labels:
    app: swissbrain
    environment: staging
data:
  # Environment
  NODE_ENV: "staging"
  ENVIRONMENT: "staging"
  LOG_LEVEL: "info"
  DEBUG: "false"

  # Application
  APP_NAME: "SwissBrain AI (Staging)"
  APP_VERSION: "0.1.0-staging"
  APP_URL: "https://staging.swissbrain.ai"
  API_URL: "https://api-staging.swissbrain.ai"

  # Feature Flags
  ENABLE_ANALYTICS: "true"
  ENABLE_ERROR_TRACKING: "true"
  ENABLE_RATE_LIMITING: "true"
  ENABLE_CACHING: "true"
  ENABLE_DEBUG_MODE: "false"

  # Redis Configuration
  REDIS_HOST: "redis.swissbrain.svc.cluster.local"
  REDIS_PORT: "6379"
  REDIS_DB: "1"  # Use different DB than production
  REDIS_TLS_ENABLED: "false"

  # Database
  DB_SSL_MODE: "require"
  DB_POOL_MIN: "5"
  DB_POOL_MAX: "20"
  DB_IDLE_TIMEOUT: "30000"
  DB_CONNECTION_TIMEOUT: "10000"

  # API Configuration
  API_RATE_LIMIT_WINDOW: "60000"
  API_RATE_LIMIT_MAX_REQUESTS: "500"
  API_TIMEOUT: "30000"
  API_MAX_PAYLOAD_SIZE: "50mb"

  # Job Queue
  QUEUE_CONCURRENCY: "10"
  QUEUE_MAX_RETRIES: "3"
  QUEUE_RETRY_DELAY: "1000"
  QUEUE_JOB_TIMEOUT: "600000"  # 10 minutes

  # File Upload
  MAX_FILE_SIZE: "52428800"  # 50MB
  ALLOWED_FILE_TYPES: "pdf,doc,docx,txt,md,jpg,jpeg,png,gif,webp,svg"
  UPLOAD_TEMP_DIR: "/tmp/uploads"

  # Agent Configuration
  AGENT_MAX_EXECUTION_TIME: "600000"  # 10 minutes
  AGENT_MAX_MEMORY: "4096"  # 4GB
  AGENT_SANDBOX_ENABLED: "true"

  # Cache Configuration
  CACHE_TTL: "600"  # 10 minutes
  CACHE_MAX_SIZE: "500"

  # CORS Configuration
  CORS_ENABLED: "true"
  CORS_ORIGIN: "https://staging.swissbrain.ai,https://app-staging.swissbrain.ai"
  CORS_METHODS: "GET,POST,PUT,DELETE,OPTIONS,PATCH"
  CORS_CREDENTIALS: "true"

  # Session Configuration
  SESSION_SECRET_ROTATION: "true"
  SESSION_MAX_AGE: "604800000"  # 7 days
  SESSION_SECURE: "true"  # HTTPS only

  # Logging
  LOG_FORMAT: "json"
  LOG_COLORIZE: "false"
  LOG_INCLUDE_TIMESTAMP: "true"

  # Monitoring
  METRICS_ENABLED: "true"
  METRICS_PORT: "9090"
  HEALTH_CHECK_PATH: "/health"

  # Development Tools
  HOT_RELOAD_ENABLED: "false"
  SOURCE_MAPS_ENABLED: "true"
  PROFILING_ENABLED: "false"

  # Timeouts
  HTTP_TIMEOUT: "30000"
  WS_TIMEOUT: "60000"
  GRACEFUL_SHUTDOWN_TIMEOUT: "30000"

  # Security
  HELMET_ENABLED: "true"
  RATE_LIMIT_ENABLED: "true"
  CSRF_ENABLED: "true"
